<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>scarlet.fft &#8212; scarlet  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="api/api/scarlet.fft.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="scarlet.frame" href="scarlet.frame.html" />
    <link rel="prev" title="scarlet.display" href="scarlet.display.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.svg" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0-quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../1-concepts.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="scarlet.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scarlet.bbox.html">scarlet.bbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.blend.html">scarlet.blend</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.cache.html">scarlet.cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.component.html">scarlet.component</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.constraint.html">scarlet.constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.detect.html">scarlet.detect</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.display.html">scarlet.display</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">scarlet.fft</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.frame.html">scarlet.frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.initialization.html">scarlet.initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.interpolation.html">scarlet.interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.measure.html">scarlet.measure</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.model.html">scarlet.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.morphology.html">scarlet.morphology</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.observation.html">scarlet.observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.operator.html">scarlet.operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.parameter.html">scarlet.parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.prior.html">scarlet.prior</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.psf.html">scarlet.psf</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.renderer.html">scarlet.renderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.source.html">scarlet.source</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.spectrum.html">scarlet.spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="scarlet.wavelet.html">scarlet.wavelet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../regression.html">Regression Testing</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-scarlet.fft">
<span id="scarlet-fft"></span><h1>scarlet.fft<a class="headerlink" href="#module-scarlet.fft" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="scarlet.fft.Fourier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scarlet.fft.</span></span><span class="sig-name descname"><span class="pre">Fourier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_fft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scarlet/fft.html#Fourier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scarlet.fft.Fourier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>An array that stores its Fourier Transform</p>
<p>The <cite>Fourier</cite> class is used for images that will make
use of their Fourier Transform multiple times.
In order to prevent numerical artifacts the same image
convolved with different images might require different
padding, so the FFT for each different shape is stored
in a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#scarlet.fft.Fourier.image" title="scarlet.fft.Fourier.image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code></a></dt><dd><p>The real space image</p>
</dd>
<dt><a class="reference internal" href="#scarlet.fft.Fourier.shape" title="scarlet.fft.Fourier.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></a></dt><dd><p>The shape of the real space image</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#scarlet.fft.Fourier.fft" title="scarlet.fft.Fourier.fft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fft</span></code></a>(fft_shape, axes)</p></td>
<td><p>The FFT of an image for a given <cite>fft_shape</cite> along desired <cite>axes</cite></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#scarlet.fft.Fourier.from_fft" title="scarlet.fft.Fourier.from_fft"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_fft</span></code></a>(image_fft, fft_shape, image_shape)</p></td>
<td><p>Generate a new Fourier object from an FFT dictionary</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="scarlet.fft.Fourier.fft">
<span class="sig-name descname"><span class="pre">fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fft_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scarlet/fft.html#Fourier.fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scarlet.fft.Fourier.fft" title="Permalink to this definition">¶</a></dt>
<dd><p>The FFT of an image for a given <cite>fft_shape</cite> along desired <cite>axes</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scarlet.fft.Fourier.from_fft">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_fft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scarlet/fft.html#Fourier.from_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scarlet.fft.Fourier.from_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a new Fourier object from an FFT dictionary</p>
<p>If the fft of an image has been generated but not its
real space image (for example when creating a convolution kernel),
this method can be called to create a new <cite>Fourier</cite> instance
from the k-space representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image_fft: array</strong></dt><dd><p>The FFT of the image.</p>
</dd>
<dt><strong>fft_shape: tuple</strong></dt><dd><p>“Fast” shape of the image used to generate the FFT.
This will be different than <cite>image_fft.shape</cite> if
any of the dimensions are odd, since <cite>np.fft.rfft</cite>
requires an even number of dimensions (for symmetry),
so this tells <cite>np.fft.irfft</cite> how to go from
complex k-space to real space.</p>
</dd>
<dt><strong>image_shape: tuple</strong></dt><dd><p>The shape of the image <em>before padding</em>.
This will regenerate the image with the extra
padding stripped.</p>
</dd>
<dt><strong>axes: int or tuple</strong></dt><dd><p>The dimension(s) of the array that will be transformed.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>result: <cite>Fourier</cite></dt><dd><p>A <cite>Fourier</cite> object generated from the FFT.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="scarlet.fft.Fourier.image">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image</span></span><a class="headerlink" href="#scarlet.fft.Fourier.image" title="Permalink to this definition">¶</a></dt>
<dd><p>The real space image</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="scarlet.fft.Fourier.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#scarlet.fft.Fourier.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>The shape of the real space image</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scarlet.fft.convolve">
<span class="sig-prename descclassname"><span class="pre">scarlet.fft.</span></span><span class="sig-name descname"><span class="pre">convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-2,</span> <span class="pre">-1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_Fourier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scarlet/fft.html#convolve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scarlet.fft.convolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolve image with a kernel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>image: array or `Fourier`</strong></dt><dd><p>Image either as array or as <cite>Fourier</cite> object</p>
</dd>
<dt><strong>kernel: array or `Fourier`</strong></dt><dd><p>Convolution kernel either as array or as <cite>Fourier</cite> object</p>
</dd>
<dt><strong>padding: int</strong></dt><dd><p>Additional padding to use when generating the FFT
to supress artifacts.</p>
</dd>
<dt><strong>axes: tuple or None</strong></dt><dd><p>Axes that contain the spatial information for the PSFs.</p>
</dd>
<dt><strong>return_Fourier: bool</strong></dt><dd><p>Whether to return <cite>Fourier</cite> or array</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scarlet.fft.match_psf">
<span class="sig-prename descclassname"><span class="pre">scarlet.fft.</span></span><span class="sig-name descname"><span class="pre">match_psf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psf1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-2,</span> <span class="pre">-1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_Fourier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scarlet/fft.html#match_psf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scarlet.fft.match_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the difference kernel to match psf1 to psf2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>psf1: array or `Fourier`</strong></dt><dd><p>PSF1 either as array or as <cite>Fourier</cite> object</p>
</dd>
<dt><strong>psf2: array or `Fourier`</strong></dt><dd><p>PSF1 either as array or as <cite>Fourier</cite> object</p>
</dd>
<dt><strong>padding: int</strong></dt><dd><p>Additional padding to use when generating the FFT
to supress artifacts.</p>
</dd>
<dt><strong>axes: tuple or None</strong></dt><dd><p>Axes that contain the spatial information for the PSFs.</p>
</dd>
<dt><strong>return_Fourier: bool</strong></dt><dd><p>Whether to return <cite>Fourier</cite> or array</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="scarlet.fft.shift">
<span class="sig-prename descclassname"><span class="pre">scarlet.fft.</span></span><span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-2,</span> <span class="pre">-1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_Fourier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/scarlet/fft.html#shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scarlet.fft.shift" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018-2024, Fred Moolekamp and Peter Melchior.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/api/scarlet.fft.rst"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>