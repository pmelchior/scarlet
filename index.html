<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>scarlet Documentation &#8212; scarlet  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="api/index.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="install.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="#">
              <img class="logo" src="_static/logo.svg" alt="Logo"/>
            </a></p>
<h3><a href="#">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="0-quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="1-concepts.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/scarlet.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression.html">Regression Testing</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="scarlet-documentation">
<h1><em>scarlet</em> Documentation<a class="headerlink" href="#scarlet-documentation" title="Permalink to this heading">¶</a></h1>
<p><em>scarlet</em> is an open source python library for modeling astronomical sources from
multi-band, multi-epoch, and multi-instrument data.</p>
</section>
<section id="getting-started">
<span id="id1"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="0-quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="0-quickstart.html#Load-and-Display-Data">Load and Display Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="0-quickstart.html#Define-Model-Frame-and-Observation">Define Model Frame and Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="0-quickstart.html#Initialize-sources">Initialize sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="0-quickstart.html#Create-and-Fit-Model">Create and Fit Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="0-quickstart.html#Interact-with-Results">Interact with Results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="1-concepts.html">Core Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Observation">Observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Frame">Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Source">Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Blend">Blend</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Parameter">Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Step-Size">Step Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Prior">Prior</a></li>
<li class="toctree-l2"><a class="reference internal" href="1-concepts.html#Constraint">Constraint</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/display.html">Displaying Scenes</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/point_source.html">Point Source Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/wavelet_model.html">Starlet Tutorial: Modeling a Low Surface Brightness Galaxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/multiresolution.html">Multi-Resolution Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/lite.html">Scarlet Lite Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/multiscale_deblending.html">Multiscale deblending tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/scarlet.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.bbox.html">scarlet.bbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.blend.html">scarlet.blend</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.cache.html">scarlet.cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.component.html">scarlet.component</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.constraint.html">scarlet.constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.detect.html">scarlet.detect</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.display.html">scarlet.display</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.fft.html">scarlet.fft</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.frame.html">scarlet.frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.initialization.html">scarlet.initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.interpolation.html">scarlet.interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.measure.html">scarlet.measure</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.model.html">scarlet.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.morphology.html">scarlet.morphology</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.observation.html">scarlet.observation</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.operator.html">scarlet.operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.parameter.html">scarlet.parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.prior.html">scarlet.prior</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.psf.html">scarlet.psf</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.renderer.html">scarlet.renderer</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.source.html">scarlet.source</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.spectrum.html">scarlet.spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/scarlet.wavelet.html">scarlet.wavelet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="regression.html">Regression Testing</a></li>
</ul>
</div>
</section>
<section id="change-log">
<h1>Change Log<a class="headerlink" href="#change-log" title="Permalink to this heading">¶</a></h1>
<section id="id2">
<h2>1.1 (2020-07-14)<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h2>
<section id="general">
<h3>General<a class="headerlink" href="#general" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Introduction of <cite>Spectrum</cite> and <cite>Morphology</cite> classes (both inherited from <cite>Factor</cite>) to modularize <cite>FactorizedComponent</cite>. They implement <cite>get_model</cite> member functions which create the representation of the spectrum and morphology model from whatever it uses as parameters.</p></li>
<li><p><cite>Component.sed</cite> has been renamed to <cite>Component.spectrum</cite>.</p></li>
<li><p><cite>Component.morph</cite> has been renamed to <cite>Component.morphology</cite>.</p></li>
<li><p><cite>FunctionComponent</cite> has been deprecated.</p></li>
<li><p>Initialization and plotting functions are now consistent for multi-observation data sets.</p></li>
</ul>
</section>
<section id="new-features">
<h3>New Features<a class="headerlink" href="#new-features" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>One can now e.g. combine a custom spectrum model with an existing <cite>PointSourceMorphology</cite>.</p></li>
<li><p><cite>Box</cite> can now be sliced for lower dimensional subset; two Boxes can be combined with <cite>&#64;</cite> to create a higher-dimensional box.</p></li>
<li><p><cite>display</cite> functions can now show the source boxes.</p></li>
</ul>
</section>
</section>
<section id="id3">
<h2>1.0 (2019-12-22)<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<section id="id4">
<h3>General<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Complete overhaul of the modeling code. It now allows for arbitrary <cite>Parameter</cite>
instances to generate a source model (e.g. point-source or Sersic fitting).</p></li>
<li><p>Each <cite>Parameter</cite> can be further constrained by proximal constraints or priors.</p></li>
<li><p>New optimizer from the <cite>proxmin</cite> package: <cite>adaprox</cite> is an adaptive proximal gradient
method that doesn’t require Lipschitz constants and uses different steps sizes for
each element of an optimization parameter.</p></li>
</ul>
</section>
<section id="id5">
<h3>New Features<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>Prior</cite> can now be attached to a <cite>Parameter</cite> and its gradient will be added to likelihood gradients.</p></li>
<li><p><cite>PointSource</cite> performs optimization of centroid position and flux assuming the model PSF.</p></li>
<li><p><cite>Fourier</cite> helps with the bookkeeping involved with calculating FFTs to different shapes.</p></li>
<li><p>Most <cite>scarlet</cite> objects can be pickled. That allows to store sources and reload sources.</p></li>
<li><p><cite>Component</cite> has <cite>Box</cite> to confine its footprint and save memory.</p></li>
<li><p><cite>scarlet.display</cite> has methods to <cite>show_scene</cite> and <cite>show_sources</cite> which allow fast inspection.</p></li>
<li><p><cite>scarlet.measure</cite> has methods to perform measurements on the component models.</p></li>
</ul>
</section>
<section id="api-changes">
<h3>API Changes<a class="headerlink" href="#api-changes" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>Frame</cite> and <cite>Observation</cite> strongly prefer all arguments (<cite>weights</cite>, <cite>psfs</cite>, <cite>channels</cite>, <cite>wcs</cite>) to be set.</p></li>
<li><p><cite>Frame.psfs</cite> (or <cite>Observation.Frame.psfs</cite>) now stores a <cite>PSF</cite> object, and the <cite>PSF.image</cite> method needs to be called
to access the PSF image cube.</p></li>
<li><p><cite>ExtendedSource</cite> does not accept <cite>bg_rms</cite> keyword. This information is derived from
<cite>observation.weights</cite>.</p></li>
</ul>
</section>
</section>
<section id="id6">
<h2>0.5 (2019-06-26)<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<section id="id7">
<h3>General<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Completely restructured code, including using <cite>autograd</cite> package to calculate gradients.</p></li>
<li><p>PSF convolutions are now performed on the model of the entire blend as opposed to
individually for each source.</p></li>
<li><p><cite>Blend</cite> no longer fits for source positions. Instead it is up to the user to implement a
centering algorithm, such as centroiding or the <cite>scarlet.update.fix_pixel_center</cite>.</p></li>
<li><p>Updates to all of the docs and tutorials to match the new API.</p></li>
</ul>
</section>
<section id="id8">
<h3>New Features<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Multi-resolution deblending.</p></li>
<li><p>A <cite>BoundingBox</cite> container to define rectangular regions in the pixel grid, a <cite>trim</cite> function
to strip away all pixels lower than a cutoff value, and a <cite>flux_at_edge</cite> method to determine if
a model has flux on the edge of the image.</p></li>
<li><p>A <cite>Scene</cite> class to handle the metadata for the deblended model.</p></li>
<li><p>An <cite>Observation</cite> class to provide mappings from the model scene to a set
of observations with potentially multiple filter bands.</p></li>
<li><p>A <cite>LowResObservation</cite> class for observations with lower resolution than the blended model,
requiring resampling and reprojection.</p></li>
<li><p>A <cite>BlendFlag</cite> has been introduced to keep track of things that might have gone wrong
while debending.</p></li>
<li><p>A gradient <cite>Prior</cite> class has been created to allow users to update the gradient of a parameter
in a source or <cite>Component</cite>.</p></li>
<li><p>Color normalization imports from <cite>astropy.visualization</cite>, with the addition of <cite>img_to_channels</cite> to
map any number of filter bands to an RGB that can be displayed.</p></li>
<li><p>A <cite>CombinedExtendedSource</cite> initializes sources with multiple observations at different pixel
resolutions.</p></li>
<li><p><cite>Frame</cite> issues warnings when PSF is not specified or not normalized.</p></li>
<li><p><cite>Frame.channels</cite> is used to identify channels in multiple observations.</p></li>
<li><p>PSF convolutions and ffts of image cubes are performed using ndimensional fft along selected axes for better performance.</p></li>
</ul>
</section>
<section id="id9">
<h3>API Changes<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>Scene</cite> is a is a confusing name and has been renamed to <cite>Frame</cite>.</p></li>
<li><p><cite>Observation.get_model</cite> is a confusing name and has been renamed to <cite>Observation.render</cite>.</p></li>
<li><p><cite>Blend</cite> does not have a <cite>frame</cite> argument any more, it inherits its frame from sources.</p></li>
<li><p><cite>Component</cite> is now the base class for sources and <cite>Source</cite> has been removed
<cite>PointSource</cite>, <cite>ExtendedSource</cite>, and <cite>MultiComponentSource</cite> are now inherited from <cite>Component</cite>.</p></li>
<li><p>The <cite>Constraint</cite> class and module were removed in place of an update method that
has been added to <cite>Component`s (and thus sources). User defined constraints should now inherit
from `Component</cite> or one of its subclasses and overwrite the <cite>update</cite> method. Constraints are
now applied using functions from the <cite>scarlet.update</cite> module or similar user defined update
functions.</p></li>
<li><p><cite>get_model</cite> has been simplified for <cite>ComponentTree</cite> and <cite>Components</cite> to always return the
entire scene with the component added in place, using the <cite>Scene</cite> target <cite>PSF</cite>. To get a
model in the same space as observations requires calling <cite>Observation.get_model</cite> and passing
the high resolution/best seeing model.</p></li>
<li><p><cite>Frame</cite> has a <cite>channels</cite> argument instead of <cite>filter_curves</cite>.</p></li>
<li><p>The old <cite>resampling.py</cite> module has been renamed <cite>interpolation.py</cite> and a new <cite>resampling.py</cite>
used for multi-resolution resampling/reprojection.</p></li>
<li><p>Sources and components are no longer centered in a small patch that is reprojected
into the model frame. Instead components can exist anywhere on an image and constraints that
require a center, such as symmetry and monotonicity, can use the new <cite>uncentered_operator</cite> method.</p></li>
<li><p><cite>make_operator</cite> is now a method of the <cite>LowResObservation</cite> class as should be.</p></li>
</ul>
</section>
</section>
<section id="id10">
<h2>0.45 (2019-3-27)<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h2>
<section id="id11">
<h3>General<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Tests have been added for the <cite>operator</cite>, <cite>constraint</cite>, <cite>resample</cite>, and <cite>transformation</cite>
modules. Tests are run on Travis CI with each new build.</p></li>
</ul>
</section>
<section id="id12">
<h3>New Features<a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Convolutions can now be done in Fourier space and/or real
space by setting the <cite>use_fft</cite> option in <cite>config.Config</cite>.</p></li>
<li><p>A new internal function was added to project images into larger or
smaller images by slicing and/or padding.</p></li>
<li><p>Interpolation kernels have been implemented for fractional pixel shifts using
bilinear, cubic spline, and Lanczos algorithms.</p></li>
</ul>
</section>
</section>
<section id="id13">
<h2>0.4 (2019-2-15)<a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h2>
<section id="id14">
<h3>General<a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Dropped python 2 support</p></li>
</ul>
</section>
<section id="id15">
<h3>New Features<a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Initialization of <cite>PointSource</cite>, <cite>ExtendedSource</cite>, and
<cite>MultiComponentSource</cite> now take <cite>normalization</cite> as an
input parameter, which selects the normalization used
to break the color/morphology degeneracy. The default is to
use <cite>constraint.Normalization.Smax</cite>, which normalizes
<cite>S</cite> (morphology) so that the peak pixel always has a value
of one.</p></li>
<li><p>The <cite>exact_lipschitz</cite> option has been added to <cite>Config</cite>.
This allows the user to recalculate the <cite>Lipschitz</cite> constant
(used for calculating step sizing) in each iteration as opposed
to an approximation (the default) used for speed.</p></li>
</ul>
</section>
<section id="id16">
<h3>API Changes<a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>The default value of the <cite>Config</cite> parameter <cite>accelerated</cite>
is now <cite>False</cite>. This was done because in some cases
acceleration caused the optimization to diverge, and because
the new S matrix normalization causes the code to run faster
than the old accelerated version for most blends.</p></li>
<li><p>Due to the additional normalization parameters, a <cite>get_flux</cite>
method has been added to properly get the flux of an object
in each band.</p></li>
</ul>
</section>
<section id="bug-fixes">
<h3>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Monotonicity would break if the bounding box for a <cite>Source</cite> was not odd.
The shape is now forced to be odd when the <cite>Source</cite> is initialized.</p></li>
<li><p><cite>fix_sed</cite> and <cite>fix_morph</cite> were not correctly passing the SED and morphology
though correctly, but this behavior has been corrected.</p></li>
<li><p>Installations that do not have access to get the current commit using git
will now truncate the release number to the subversion. This was needed for
binary installs (like the LSST-DM stack).</p></li>
</ul>
</section>
<section id="other-changes-and-additions">
<h3>Other Changes and Additions<a class="headerlink" href="#other-changes-and-additions" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>The names of the sub modules <cite>operators</cite>, <cite>constraints</cite>, <cite>transformations</cite>,
have been changed to the singular <cite>operator</cite>, <cite>constraint</cite>, <cite>transformation</cite>.</p></li>
<li><p>Internally the logic that separates <cite>Component</cite>, <cite>Source</cite>, and <cite>Blend</cite> objects
has been clarified. A <cite>Source</cite> is just a collection of components with relatively
no internal logic other than initialization. <cite>ComponentTree</cite> is a hierarchical
list of components that replaces the old <cite>ComponentList</cite> class, making it easier
to have more complicated objects and improving the internal interface to them.</p></li>
<li><p>The internal resizing and re-centering algorithms have been updated.</p></li>
</ul>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018-2024, Fred Moolekamp and Peter Melchior.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/index.rst"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>